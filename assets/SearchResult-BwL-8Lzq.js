import{u as U,f as Z,g as ee,h as I,i as te,j as ae,t as le,k as se,l as D,m as q,n as ne,p as M,q as a,s as oe,R as T,v as re,x as ie,y as ue,z as $,A as O,B as ce,C as he,D as pe,E as ve,O as de,F as ge,G as ye,P as me,H as ke,I as we,J as _}from"./app-DxOkGf6w.js";const Ee=["/","/about/","/help/java-installation-and-configuration.html","/help/maven-test1.html","/help/MyBatis-CURD.html","/help/quickly-build-personal-documents.html","/help/Spring-practice1.html","/links/","/notes/software/gradle.html","/notes/software/idea.html","/notes/software/maven.html","/notes/software/","/notes/software/vscode.html","/notes/language/java/java-collection.html","/notes/language/java/java-concurrent.html","/notes/language/java/java-index.html","/notes/language/java/java-jvm.html","/notes/language/java/java-spi.html","/notes/language/java/java-yuyan.html","/notes/language/java/","/notes/language/js/","/notes/language/python/python-asyncio.html","/notes/language/python/python-bisect.html","/notes/language/python/python-concurrent.html","/notes/language/python/python-data-structures.html","/notes/language/python/python-log.html","/notes/language/python/python-ordchr.html","/notes/language/python/python-sort.html","/notes/language/python/","/notes/software/docker/docker-intro.html","/notes/software/git/git.html","/notes/Specialized_knowledge/linux/linux-j-cpu.html","/notes/Specialized_knowledge/linux/linux-j-disk.html","/notes/Specialized_knowledge/linux/linux-j-mem.html","/notes/Specialized_knowledge/linux/linux-j-net.html","/notes/Specialized_knowledge/linux/linux-j-ps.html","/notes/Specialized_knowledge/linux/monitor-overview.html","/notes/Specialized_knowledge/linux/shell.html","/notes/Specialized_knowledge/mysql/summary.html","/notes/Specialized_knowledge/mysql/transaction.html","/notes/Specialized_knowledge/network/http.html","/notes/Specialized_knowledge/network/ip.html","/notes/Specialized_knowledge/network/summary.html","/notes/Specialized_knowledge/network/tcp.html","/notes/Specialized_knowledge/operation_system/summary.html","/404.html","/help/","/notes/","/notes/language/","/notes/software/docker/","/notes/software/git/","/notes/Specialized_knowledge/linux/","/notes/Specialized_knowledge/","/notes/Specialized_knowledge/mysql/","/notes/Specialized_knowledge/network/","/notes/Specialized_knowledge/operation_system/","/category/","/category/%E7%AC%94%E8%AE%B0/","/category/api/","/category/%E5%AE%B9%E5%99%A8/","/category/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/","/category/linux/","/tag/","/tag/python/","/tag/%E5%B9%B6%E5%8F%91/","/tag/%E5%BC%82%E6%AD%A5io/","/tag/%E5%8D%8F%E7%A8%8B/","/tag/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/","/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","/tag/%E6%97%A5%E5%BF%97/","/tag/%E6%8E%92%E5%BA%8F/","/tag/docker/","/tag/git/","/article/","/star/","/timeline/"],fe="SEARCH_PRO_QUERY_HISTORY",d=U(fe,[]),Se=()=>{const{queryHistoryCount:l}=_,s=l>0;return{enabled:s,queryHistory:d,addQueryHistory:n=>{s&&(d.value.length<l?d.value=Array.from(new Set([n,...d.value])):d.value=Array.from(new Set([n,...d.value.slice(0,l-1)])))},removeQueryHistory:n=>{d.value=[...d.value.slice(0,n),...d.value.slice(n+1)]}}},F=l=>Ee[l.id]+("anchor"in l?`#${l.anchor}`:""),xe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:B}=_,g=U(xe,[]),je=()=>{const l=B>0;return{enabled:l,resultHistory:g,addResultHistory:s=>{if(l){const n={link:F(s),display:s.display};"header"in s&&(n.header=s.header),g.value.length<B?g.value=[n,...g.value]:g.value=[n,...g.value.slice(0,B-1)]}},removeResultHistory:s=>{g.value=[...g.value.slice(0,s),...g.value.slice(s+1)]}}},_e=l=>{const s=ce(),n=I(),H=he(),r=D(!1),k=pe([]);return ve(()=>{const{search:f,terminate:y}=de(),S=()=>{k.value=[],r.value=!1},w=we(c=>{const E=c.join(" "),{searchFilter:A=v=>v,splitWord:R,suggestionsFilter:b,...m}=s.value;r.value=!0,E?f(c.join(" "),n.value,m).then(v=>A(v,E,n.value,H.value)).then(v=>{k.value=v,r.value=!1}).catch(v=>{console.error(v),S()}):S()},_.searchDelay-_.suggestDelay);M([l,n],([c])=>w(c),{immediate:!0}),ge(()=>{y()})}),{searching:r,results:k}};var Ae=Z({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:s}){const n=ee(),H=I(),r=te(ae),{enabled:k,addQueryHistory:f,queryHistory:y,removeQueryHistory:S}=Se(),{enabled:w,resultHistory:c,addResultHistory:E,removeResultHistory:A}=je(),R=k||w,b=le(l,"queries"),{results:m,searching:v}=_e(b),o=se({isQuery:!0,index:0}),h=D(0),p=D(0),L=q(()=>R&&(y.value.length>0||c.value.length>0)),z=q(()=>m.value.length>0),C=q(()=>m.value[h.value]||null),Y=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?c.value.length-1:y.value.length-1):o.index=t-1},G=()=>{const{isQuery:e,index:t}=o;t===(e?y.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},J=()=>{h.value=h.value>0?h.value-1:m.value.length-1,p.value=C.value.contents.length-1},V=()=>{h.value=h.value<m.value.length-1?h.value+1:0,p.value=0},K=()=>{p.value<C.value.contents.length-1?p.value+=1:V()},N=()=>{p.value>0?p.value-=1:J()},Q=e=>e.map(t=>ye(t)?t:a(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=me[e.index]||"$content",[i,j=""]=ke(t)?t[H.value].split("$content"):t.split("$content");return e.display.map(u=>a("div",Q([i,...u,j])))}return e.display.map(t=>a("div",Q(t)))},x=()=>{h.value=0,p.value=0,s("updateQuery",""),s("close")};return ne("keydown",e=>{if(l.isFocusing){if(z.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=C.value.contents[p.value];f(l.queries.join(" ")),E(t),n.push(F(t)),x()}}else if(w){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(s("updateQuery",y.value[t]),e.preventDefault()):(n.push(c.value[t].link),x())}}}}),M([h,p],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>a("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!z.value:!L.value}],id:"search-pro-results"},l.queries.length?v.value?a(oe,{hint:r.value.searching}):z.value?a("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},i)=>{const j=h.value===i;return a("li",{class:["search-pro-result-list-item",{active:j}]},[a("div",{class:"search-pro-result-title"},e||r.value.defaultTitle),t.map((u,X)=>{const P=j&&p.value===X;return a(T,{to:F(u),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{f(l.queries.join(" ")),E(u),x()}},()=>[u.type==="text"?null:a(u.type==="title"?re:u.type==="heading"?ie:ue,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[u.type==="text"&&u.header?a("div",{class:"content-header"},u.header):null,a("div",W(u))])])})])})):r.value.emptyResult:R?L.value?[k?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},r.value.queryHistory),y.value.map((e,t)=>a("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{s("updateQuery",e)}},[a($,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},e),a("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:i=>{i.preventDefault(),i.stopPropagation(),S(t)}})]))])):null,w?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},r.value.resultHistory),c.value.map((e,t)=>a(T,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{x()}},()=>[a($,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[e.header?a("div",{class:"content-header"},e.header):null,a("div",e.display.map(i=>Q(i)).flat())]),a("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:i=>{i.preventDefault(),i.stopPropagation(),A(t)}})]))])):null]:r.value.emptyHistory:r.value.emptyResult)}});export{Ae as default};
